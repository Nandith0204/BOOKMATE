version: "3.1"

rules:
# -----------------
# Default Rules
# -----------------
- rule: Say goodbye anytime the user says goodbye
  steps:
    - intent: goodbye
    - action: utter_goodbye

- rule: Say 'I am a bot' anytime the user challenges
  steps:
    - intent: bot_challenge
    - action: utter_iamabot

# -----------------
# Form Activation/Submission Rules
# -----------------
- rule: Activate recommendation form when mood is expressed
  steps:
    - intent: express_mood
    - action: recommendation_form
    - active_loop: recommendation_form

- rule: Submit form and run custom action
  condition:
    # Rule only applies when the form is active
    - active_loop: recommendation_form 
  steps:
    # 1. The form action checks if all required slots (mood_type, mood_preference) are filled
    - action: recommendation_form
    # 2. If slots are filled, the form deactivates
    - active_loop: null
    # 3. The custom action runs to provide the specific cheer-up message and book recommendation
    - action: action_recommend_by_mood